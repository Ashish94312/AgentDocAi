# RepoDoc-AI Deployment Guide for Render

## Prerequisites

1. **GitHub Repository**: Your code should be pushed to a GitHub repository
2. **Render Account**: Sign up at [render.com](https://render.com)
3. **API Keys**: You'll need:
   - GitHub Personal Access Token
   - OpenAI API Key

## Deployment Steps

### 1. Push Your Code to GitHub

```bash
git add .
git commit -m "Prepare for Render deployment"
git push origin main
```

### 2. Create Render Account and Connect GitHub

1. Go to [render.com](https://render.com) and sign up
2. Connect your GitHub account
3. Import your repository

### 3. Create Database

1. In Render dashboard, click "New +" → "PostgreSQL"
2. Name: `repodoc_ai`
3. Plan: Free
4. Click "Create Database"
5. Note the connection details

### 4. Create Web Service

1. In Render dashboard, click "New +" → "Web Service"
2. Connect your GitHub repository
3. Configure the service:

**Basic Settings:**
- Name: `repodoc-ai`
- Runtime: `Python 3`
- Build Command: `cd mcp_integration && chmod +x build.sh && ./build.sh`
- Start Command: `cd mcp_integration && source venv/bin/activate && python manage.py migrate && python manage.py collectstatic --noinput && gunicorn mcp_integration.wsgi:application --bind 0.0.0.0:$PORT --workers 2 --timeout 120 --max-requests 1000 --max-requests-jitter 100 --preload`

**Environment Variables:**
Add these environment variables in the Render dashboard:

```
DEBUG=False
SECRET_KEY=your-secret-key-will-be-generated
ALLOWED_HOSTS=repodoc-ai.onrender.com
DATABASE_URL=postgresql://user:password@host:port/database
GITHUB_PERSONAL_ACCESS_TOKEN=your_github_token_here
OPENAI_API_KEY=your_openai_api_key_here
WEB_CONCURRENCY=2
```

**Note:** 
- `DATABASE_URL` will be automatically set when you connect the database
- `SECRET_KEY` can be generated by Render (check "Generate" option)
- Replace `your_github_token_here` and `your_openai_api_key_here` with your actual API keys

### 5. Connect Database to Web Service

1. In your web service settings, go to "Environment"
2. Add environment variable:
   - Key: `DATABASE_URL`
   - Value: Select "From Database" → Choose your `repodoc_ai` database

### 6. Deploy

1. Click "Create Web Service"
2. Render will automatically build and deploy your application
3. Monitor the build logs for any issues

## Important Notes

### GitHub MCP Server Limitation

**⚠️ Important:** The GitHub MCP server (Go binary) cannot run on Render's free tier because:
- Render free tier doesn't support custom binaries
- The MCP server requires system-level access

**Workarounds:**
1. **Use GitHub API directly** (modify the code to use GitHub API instead of MCP)
2. **Upgrade to paid plan** and use Docker deployment
3. **Use alternative hosting** that supports custom binaries

### Current Deployment Status

The current configuration will deploy the Django application successfully, but the MCP integration will not work on Render's free tier. You'll need to modify the code to use GitHub API directly for full functionality.

## Troubleshooting

### Common Issues

1. **Build Fails**: Check build logs for missing dependencies
2. **Database Connection**: Ensure DATABASE_URL is properly set
3. **Static Files**: Make sure collectstatic runs successfully
4. **Environment Variables**: Verify all required variables are set

### Logs

Check the Render dashboard logs for detailed error information:
- Build logs: Show build process
- Runtime logs: Show application runtime errors

## Alternative Deployment Options

If you need the MCP server functionality:

1. **Railway**: Supports custom binaries
2. **DigitalOcean App Platform**: Supports Docker
3. **Heroku**: Paid plans support custom buildpacks
4. **Self-hosted**: VPS with Docker support

## Next Steps

1. Deploy the basic Django application first
2. Test the web interface
3. Modify the code to use GitHub API directly instead of MCP
4. Re-deploy with full functionality

## Support

If you encounter issues:
1. Check Render build/runtime logs
2. Verify environment variables
3. Test locally with production settings
4. Check Django documentation for deployment best practices
